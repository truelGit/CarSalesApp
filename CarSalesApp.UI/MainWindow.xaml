<Window x:Class="CarSalesApp.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:local="clr-namespace:CarSalesApp.UI"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Продажи авто" Height="600" Width="1000">
	<Window.DataContext>
		<local:MainViewModel/>
	</Window.DataContext>
	<Window.Resources>
		<local:GreaterThan25MillionConverter x:Key="HighlightConverter" />
	</Window.Resources>

	<DockPanel Margin="10">
		<StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="0 0 0 10" HorizontalAlignment="Left">
			<StackPanel.Resources>
				<Style TargetType="UIElement">
					<Setter Property="FrameworkElement.Margin" Value="0,0,10,0"/>
				</Style>
			</StackPanel.Resources>

			<ComboBox Width="100" ItemsSource="{Binding Years}" SelectedItem="{Binding SelectedYear}" />
			<ComboBox Width="200" ItemsSource="{Binding Models}" SelectedItem="{Binding SelectedModel}" />
			<Button Content="Обновить" Command="{Binding LoadDataCommand}" />
			<Button Content="Экспорт в Excel" Command="{Binding ExportToExcelCommand}" Margin="10,0,0,0"/>
		</StackPanel>

		<DataGrid ItemsSource="{Binding Sales}" AutoGenerateColumns="False" HeadersVisibility="Column"
                  CanUserAddRows="False" CanUserDeleteRows="False">
			<DataGrid.Columns>
				<DataGridTextColumn Header="Модель" Binding="{Binding ModelName}" Width="*" />

					<DataGridTextColumn Header="Январь" Binding="{Binding MonthlyTotals[0], StringFormat=N0}">
						<DataGridTextColumn.ElementStyle>
							<Style TargetType="TextBlock">
								<Setter Property="Background" Value="{Binding MonthlyTotals[0], Converter={StaticResource HighlightConverter}}" />
							</Style>
						</DataGridTextColumn.ElementStyle>
					</DataGridTextColumn>

					<DataGridTextColumn Header="Февраль" Binding="{Binding MonthlyTotals[1], StringFormat=N0}">
						<DataGridTextColumn.ElementStyle>
							<Style TargetType="TextBlock">
								<Setter Property="Background" Value="{Binding MonthlyTotals[1], Converter={StaticResource HighlightConverter}}" />
							</Style>
						</DataGridTextColumn.ElementStyle>
					</DataGridTextColumn>

					<DataGridTextColumn Header="Март" Binding="{Binding MonthlyTotals[2], StringFormat=N0}">
						<DataGridTextColumn.ElementStyle>
							<Style TargetType="TextBlock">
								<Setter Property="Background" Value="{Binding MonthlyTotals[2], Converter={StaticResource HighlightConverter}}" />
							</Style>
						</DataGridTextColumn.ElementStyle>
					</DataGridTextColumn>

					<DataGridTextColumn Header="Апрель" Binding="{Binding MonthlyTotals[3], StringFormat=N0}">
						<DataGridTextColumn.ElementStyle>
							<Style TargetType="TextBlock">
								<Setter Property="Background" Value="{Binding MonthlyTotals[3], Converter={StaticResource HighlightConverter}}" />
							</Style>
						</DataGridTextColumn.ElementStyle>
					</DataGridTextColumn>

					<DataGridTextColumn Header="Май" Binding="{Binding MonthlyTotals[4], StringFormat=N0}">
						<DataGridTextColumn.ElementStyle>
							<Style TargetType="TextBlock">
								<Setter Property="Background" Value="{Binding MonthlyTotals[4], Converter={StaticResource HighlightConverter}}" />
							</Style>
						</DataGridTextColumn.ElementStyle>
					</DataGridTextColumn>

					<DataGridTextColumn Header="Июнь" Binding="{Binding MonthlyTotals[5], StringFormat=N0}">
						<DataGridTextColumn.ElementStyle>
							<Style TargetType="TextBlock">
								<Setter Property="Background" Value="{Binding MonthlyTotals[5], Converter={StaticResource HighlightConverter}}" />
							</Style>
						</DataGridTextColumn.ElementStyle>
					</DataGridTextColumn>

					<DataGridTextColumn Header="Июль" Binding="{Binding MonthlyTotals[6], StringFormat=N0}">
						<DataGridTextColumn.ElementStyle>
							<Style TargetType="TextBlock">
								<Setter Property="Background" Value="{Binding MonthlyTotals[6], Converter={StaticResource HighlightConverter}}" />
							</Style>
						</DataGridTextColumn.ElementStyle>
					</DataGridTextColumn>

					<DataGridTextColumn Header="Август" Binding="{Binding MonthlyTotals[7], StringFormat=N0}">
						<DataGridTextColumn.ElementStyle>
							<Style TargetType="TextBlock">
								<Setter Property="Background" Value="{Binding MonthlyTotals[7], Converter={StaticResource HighlightConverter}}" />
							</Style>
						</DataGridTextColumn.ElementStyle>
					</DataGridTextColumn>

					<DataGridTextColumn Header="Сентябрь" Binding="{Binding MonthlyTotals[8], StringFormat=N0}">
						<DataGridTextColumn.ElementStyle>
							<Style TargetType="TextBlock">
								<Setter Property="Background" Value="{Binding MonthlyTotals[8], Converter={StaticResource HighlightConverter}}" />
							</Style>
						</DataGridTextColumn.ElementStyle>
					</DataGridTextColumn>

					<DataGridTextColumn Header="Октябрь" Binding="{Binding MonthlyTotals[9], StringFormat=N0}">
						<DataGridTextColumn.ElementStyle>
							<Style TargetType="TextBlock">
								<Setter Property="Background" Value="{Binding MonthlyTotals[9], Converter={StaticResource HighlightConverter}}" />
							</Style>
						</DataGridTextColumn.ElementStyle>
					</DataGridTextColumn>

					<DataGridTextColumn Header="Ноябрь" Binding="{Binding MonthlyTotals[10], StringFormat=N0}">
						<DataGridTextColumn.ElementStyle>
							<Style TargetType="TextBlock">
								<Setter Property="Background" Value="{Binding MonthlyTotals[10], Converter={StaticResource HighlightConverter}}" />
							</Style>
						</DataGridTextColumn.ElementStyle>
					</DataGridTextColumn>

				<DataGridTextColumn Header="Декабрь" Binding="{Binding MonthlyTotals[11], StringFormat=N0}">
					<DataGridTextColumn.ElementStyle>
						<Style TargetType="TextBlock">
							<Setter Property="Background" Value="{Binding MonthlyTotals[11], Converter={StaticResource HighlightConverter}}" />
						</Style>
					</DataGridTextColumn.ElementStyle>
				</DataGridTextColumn>
			</DataGrid.Columns>
		</DataGrid>
	</DockPanel>
</Window>
